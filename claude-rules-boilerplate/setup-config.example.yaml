# Claude Code Boilerplate — Configuration Example (v2 — 4-Layer Architecture)
# Copy this file to setup-config.yaml and customize for your project.
# Then run: ./setup.sh --config setup-config.yaml

# ═══════════════════════════════════════════════════
# SECTION 1: PROJECT IDENTITY
# ═══════════════════════════════════════════════════
project:
  name: "my-project"
  type: "api"              # api | cli | library | worker | fullstack
  purpose: "Brief description of what the project does"
  architecture: "hexagonal"  # hexagonal | clean | layered | modular

# ═══════════════════════════════════════════════════
# SECTION 2: LANGUAGE (Layer 2 — maps to languages/)
# ═══════════════════════════════════════════════════
language:
  name: "java"             # java | typescript | python | go | kotlin | rust | csharp
  version: "21"            # java: 11 | 17 | 21
                           # typescript: 5
                           # python: 3.12
                           # go: 1.22
                           # kotlin: 2.0
                           # rust: 2024
                           # csharp: 12

# ═══════════════════════════════════════════════════
# SECTION 3: FRAMEWORK (Layer 3 — maps to frameworks/)
# ═══════════════════════════════════════════════════
# Framework must be compatible with language:
#   java:       quarkus | spring-boot
#   typescript: nestjs | express | fastify
#   python:     fastapi | django | flask
#   go:         stdlib | gin | fiber
#   kotlin:     ktor | spring-boot
#   rust:       axum | actix
#   csharp:     dotnet
framework:
  name: "quarkus"
  version: "3.17"          # Optional — framework version (for version-specific rules)
  build_tool: "maven"      # java: maven | gradle
  native_build: true       # GraalVM/Mandrel (java, kotlin only — go/rust are natively compiled)

# ═══════════════════════════════════════════════════
# SECTION 4: TECHNICAL STACK
# ═══════════════════════════════════════════════════
stack:
  database:
    type: "postgresql"       # postgresql | oracle | mysql | mongodb | cassandra | sqlite | none
    migration: "flyway"      # flyway | liquibase | prisma | alembic | mongock | none

  cache:
    type: "none"             # redis | dragonfly | memcached | none

  protocols:
    - rest                   # rest | grpc | graphql | websocket | tcp-custom
    - tcp-custom

  infrastructure:
    container: "docker"           # docker | podman | none
    orchestrator: "kubernetes"    # kubernetes | docker-compose | none
    observability: "opentelemetry" # opentelemetry | datadog | prometheus-only
                                  # (always enabled — choose backend)

  # Resilience is ALWAYS mandatory — not configurable
  # Observability is ALWAYS included — only backend is configurable

  smoke_tests: true              # External smoke test scaffolding

# ═══════════════════════════════════════════════════
# SECTION 4b: SECURITY
# ═══════════════════════════════════════════════════
# Security configuration — base security rules (application-security, cryptography) are ALWAYS included.
# This section configures optional compliance frameworks and encryption settings.
security:
  # Compliance frameworks to include (list — can select multiple)
  # Each adds compliance-specific rules to .claude/rules/
  # Options: pci-dss | pci-ssf | lgpd | gdpr | hipaa | sox
  # Dependencies: pci-dss implies encryption.at_rest: true
  #               hipaa implies encryption.at_rest: true
  #               lgpd or gdpr adds PII handling rules to project identity
  compliance: []

  encryption:
    at_rest: true              # Enable encryption at rest patterns in cryptography rules
    # Key management solution — determines which KMS patterns are included
    # vault: HashiCorp Vault patterns
    # aws-kms: AWS Key Management Service patterns (requires cloud.provider: aws)
    # azure-keyvault: Azure Key Vault patterns (requires cloud.provider: azure)
    # gcp-kms: Google Cloud KMS patterns (requires cloud.provider: gcp)
    # oci-vault: OCI Vault patterns (requires cloud.provider: oci)
    # none: No specific KMS patterns (generic guidance only)
    key_management: none       # vault | aws-kms | azure-keyvault | gcp-kms | oci-vault | none

  # Include penetration testing readiness checklist
  # Adds pre-pentest hardening guide and security testing pipeline reference
  pentest_readiness: true      # true | false

# ═══════════════════════════════════════════════════
# SECTION 4c: CLOUD PROVIDER
# ═══════════════════════════════════════════════════
# Selects a cloud provider knowledge pack — a reference document mapping
# boilerplate concepts to provider-specific services.
# Knowledge packs are NOT rules — they are reference material for agents.
# Copied to .claude/skills/knowledge-packs/cloud-{provider}.md
cloud:
  provider: none               # aws | azure | gcp | oci | none

# ═══════════════════════════════════════════════════
# SECTION 4d: INFRASTRUCTURE (expanded)
# ═══════════════════════════════════════════════════
# Extended infrastructure configuration.
# NOTE: stack.infrastructure.container and stack.infrastructure.orchestrator
# are still supported for backward compatibility. If both old and new sections
# exist, the new section takes precedence.
infrastructure:
  container: docker            # docker | podman | none (overrides stack.infrastructure.container)
  orchestrator: kubernetes     # kubernetes | docker-compose | ecs | none (overrides stack.infrastructure.orchestrator)

  # Kubernetes manifest templating tool
  # kustomize: Kustomize overlays (default for kubernetes orchestrator)
  # helm: Helm charts (includes chart structure patterns)
  # none: Raw manifests
  templating: kustomize        # kustomize | helm | none

  # Infrastructure as Code tool (reference patterns only)
  # terraform: Terraform module structure, state management, CI/CD integration
  # crossplane: Kubernetes-native IaC with Compositions and Claims
  # pulumi: Code-based IaC (reference only)
  # none: No IaC patterns
  iac: none                    # terraform | crossplane | pulumi | none

  # Container registry for image storage
  # Includes tagging strategy, retention policy, vulnerability scanning patterns
  registry: none               # ecr | acr | gcr | gar | dockerhub | harbor | ghcr | none

  # API Gateway implementation
  # kong: Kong Gateway (declarative config, plugin ecosystem, KIC)
  # istio: Istio Gateway + VirtualService (requires service_mesh: istio)
  # aws-apigw: AWS API Gateway (REST API / HTTP API + Lambda)
  # traefik: Traefik IngressRoute, middleware chains, auto-cert
  # none: No gateway patterns
  api_gateway: none            # kong | istio | aws-apigw | traefik | none

  # Service mesh for inter-service communication
  # istio: Istio (mTLS, traffic management, observability)
  # linkerd: Linkerd (lightweight mTLS, transparent proxying)
  # none: No service mesh
  service_mesh: none           # istio | linkerd | none

# ═══════════════════════════════════════════════════
# SECTION 4e: DOMAIN TEMPLATE
# ═══════════════════════════════════════════════════
# Domain-specific knowledge template — generates rules/51-domain.md
# with business rules and patterns for the selected domain.
# Options:
#   iso8583: ISO 8583 payment message authorizer
#   open-banking: Open Banking / Open Finance (PIX, BACEN APIs, consent)
#   healthcare-fhir: Healthcare FHIR (HL7, SMART on FHIR, HIPAA)
#   ecommerce: E-commerce API (catalog, cart, checkout, payments)
#   saas-multitenant: SaaS multi-tenant (tenant isolation, billing, onboarding)
#   telecom-tmf: Telecom TM Forum (TMF Open APIs, SID model)
#   insurance-acord: Insurance ACORD (policy lifecycle, claims, underwriting)
#   iot-telemetry: IoT Telemetry (device registry, MQTT, edge computing)
#   custom: Empty template for manual customization
#   none: No domain template
domain:
  template: none               # iso8583 | open-banking | healthcare-fhir | ecommerce | saas-multitenant | telecom-tmf | insurance-acord | iot-telemetry | custom | none

# ═══════════════════════════════════════════════════
# SECTION 5: CONVENTIONS
# ═══════════════════════════════════════════════════
conventions:
  languages:
    code: "english"           # Language for code (classes, methods, variables)
    commits: "english"        # Language for commit messages
    documentation: "english"  # Language for docs, stories, ADRs
    logs: "english"           # Language for application log messages

  git_scopes:
    - { scope: "auth", area: "Authentication module" }
    - { scope: "billing", area: "Billing and payments" }
    - { scope: "notifications", area: "Notification system" }

# ═══════════════════════════════════════════════════
# SECTION 6: SKILLS (maps to .claude/skills/)
# ═══════════════════════════════════════════════════
# Core skills are ALWAYS included — not listed here (opt-out only).
# Core: feature_lifecycle, commit_and_push, task_decomposer,
#        group_verifier, implement_story, run_tests,
#        troubleshoot, review, review_pr, audit_rules, plan_tests

skills:
  # Conditional skills (inferred automatically by default)
  review_api: auto               # true if "rest" in protocols
  instrument_otel: auto          # true always (observability always enabled)
  setup_environment: auto        # true if orchestrator != none
  run_smoke_api: auto            # true if smoke_tests + rest
  run_smoke_socket: auto         # true if smoke_tests + tcp-custom
  run_e2e: auto
  run_perf_test: auto

# ═══════════════════════════════════════════════════
# SECTION 7: AGENTS (maps to .claude/agents/)
# ═══════════════════════════════════════════════════
# Mandatory agents (always generated, cannot be disabled):
#   architect, tech_lead, developer
# These are structural requirements of the feature lifecycle.

agents:
  # Conditional engineers (inferred automatically)
  database_engineer: auto        # true if database != none (planning + review)
  security_engineer: auto        # true always (default: true)
  qa_engineer: auto              # true always (default: true)
  performance_engineer: auto     # true always (default: true)
  observability_engineer: auto   # true always (observability always enabled)
  devops_engineer: auto          # true if container or orchestrator != none
  api_engineer: auto             # true if "rest" in protocols

  # Adaptive model tiers
  adaptive_model:
    junior: "haiku"              # Migrations, Models, Ports, DTOs, Mappers, Config
    mid: "sonnet"                # Repository, Use Case, REST Resource, Tests
    senior: "opus"               # TCP Handlers, Complex Domain Engines

# ═══════════════════════════════════════════════════
# SECTION 8: HOOKS (maps to .claude/hooks/)
# ═══════════════════════════════════════════════════
hooks:
  post_compile: auto             # auto | true | false (auto = enabled for compiled languages)

# ═══════════════════════════════════════════════════
# SECTION 9: SETTINGS (maps to .claude/settings.json)
# ═══════════════════════════════════════════════════
settings:
  auto_generate: true            # Generate settings.json with permissions
